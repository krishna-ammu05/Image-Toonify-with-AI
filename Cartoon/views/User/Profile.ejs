<% layout('User/user_Boilerplate') -%>

<div class="container my-5">
  <h1 class="mb-4"><i class="bi bi-person-circle"></i> My Profile</h1>

  <div class="row">
    <!-- Left Column -->
    <div class="col-md-4">
      <!-- Profile Card -->
      <div class="card text-center mb-4 shadow-sm">
        <div class="card-body">
          <img src="<%= user.avatar || '/images/default-avatar.png' %>" 
               alt="Profile Picture" 
               class="rounded-circle mb-3" width="100" height="100">
          <h5 class="card-title"><%= user.name %></h5>
          <p class="text-muted mb-1"><%= user.email %></p>
          <% if(user.phone){ %>
            <p class="text-muted"><%= user.phone %></p>
          <% } %>
        </div>
      </div>

      <!-- Danger Zone -->
      <div class="card border-danger shadow-sm">
        <div class="card-body">
          <h5 class="card-title text-danger">Danger Zone</h5>
          <form action="/profile/reset" method="POST" class="mb-2">
            <button type="submit" class="btn btn-danger w-100">Reset All Data</button>
          </form>
          <form action="/profile/delete" method="POST">
            <button type="submit" class="btn btn-danger w-100">Delete Account</button>
          </form>
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-md-8">
      <!-- Subscription & Plan -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Subscription & Plan</h5>
          <p>Current Plan: <strong><%= user.plan %></strong></p>
          <p>Status: <span class="badge bg-success"><%= user.subscriptionStatus %></span></p>
          <p>Renewal Date: <strong><%= user.renewalDate %></strong></p>
          <div class="mt-3">
            <a href="/subscription/upgrade" class="btn btn-success me-2">Upgrade Plan</a>
            <a href="/subscription/cancel" class="btn btn-outline-secondary">Cancel Plan</a>
          </div>
        </div>
      </div>

      <!-- Usage Stats -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Usage Stats</h5>
          <ul class="list-group list-group-flush">
            <li class="list-group-item">Total Uploads: <strong><%= user.totalUploads %></strong></li>
            <li class="list-group-item">Total Conversions: <strong><%= user.totalConversions %></strong></li>
            <li class="list-group-item">Remaining Quota: <strong><%= user.remainingQuota %></strong></li>
            <li class="list-group-item">Storage Used: <strong><%= user.storageUsed %> / <%= user.storageLimit %></strong></li>
          </ul>
        </div>
      </div>

      <!-- Personalization -->
      <div class="card mb-4 shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Personalization</h5>
          <div class="form-check form-switch mb-3">
            <input class="form-check-input" type="checkbox" id="darkModeSwitch" <%= user.darkMode ? 'checked' : '' %>>
            <label class="form-check-label" for="darkModeSwitch">Dark Mode</label>
          </div>
          <div class="mb-3">
            <label class="form-label">Preferred Output Style</label>
            <select class="form-select">
              <option <%= user.outputStyle === 'Cartoon' ? 'selected' : '' %>>Cartoon</option>
              <option <%= user.outputStyle === 'Anime' ? 'selected' : '' %>>Anime</option>
              <option <%= user.outputStyle === 'Sketch' ? 'selected' : '' %>>Sketch</option>
            </select>
          </div>
          <div>
            <label class="form-label">Language Preference</label>
            <select class="form-select">
              <option <%= user.language === 'English' ? 'selected' : '' %>>English</option>
              <option <%= user.language === 'Hindi' ? 'selected' : '' %>>Hindi</option>
              <option <%= user.language === 'Spanish' ? 'selected' : '' %>>Spanish</option>
            </select>
          </div>
        </div>
      </div>

      <!-- Recent Activity -->
      <div class="card shadow-sm">
        <div class="card-body">
          <h5 class="card-title">Recent Activity</h5>
          <p class="text-muted">No recent activity found.</p>
        </div>
      </div>
    </div>
  </div>
</div>
